<main class="main lecture">
  <!-- responsibility elements -->
  <div class="shadow-opacity"></div>
  <button class="show-aside-button">
    <div></div>
    <div></div>
    <div></div>
  </button>
  <!-- end -->

  <aside class="aside">
    <h4 class="aside__title">
      index
      <button class="close-aside-button">
        <div></div>
        <div></div>
      </button>
    </h4>
    <ul class="lecture-list">
      <li class="lecture-list-item">
        <a class="lecture-link">...</a>
      </li>
    </ul>
  </aside>
  <section class="article-container">
    <h2 class="article-title">
      ...
    </h2>
    <hr class="article-line">
    <div class="youtube-wrapper">
      <iframe
        src=""
        class="youtube-iframe"
        frameborder="0"
        allow="encrypted-media"
        allowfullscreen>
      </iframe>
    </div>
    <article class="article-contents">
      ...
    </article>
  </section>
</main>

<script>
(function() {
  // ui
  const mainElement = document.querySelector('.lecture');
  document.querySelector('.show-aside-button').onclick = () => mainElement.classList.add('main--active-show-aside');
  document.querySelector('.close-aside-button').onclick = () => mainElement.classList.remove('main--active-show-aside');
  document.querySelector('.shadow-opacity').onclick = () => mainElement.classList.remove('main--active-show-aside');

  // data
  function get(url) {
    return new Promise((resolve, reject) => {
      const req = new XMLHttpRequest();
      req.open('GET', url);
      req.send();

      req.onreadystatechange = function () {
        if (req.readyState === XMLHttpRequest.DONE) {
          if (req.status === 200) resolve(req.response);
          else reject(req.statusText);
        }
      };
    });
  }

  const paramStr = decodeURI(location.hash).split('?')[1];
  const paramArr = paramStr.split('&');
  const paramObject = {};
  paramArr.forEach((str) => {
    const [ key, value ] = str.split('=');
    paramObject[key] = value;
  })

  const requestUrl = `/edu/${paramObject.lec}/${paramObject.page}`;
  get(requestUrl).then(({ data }) => {
    const {
      index,
      titles,
      content,
      src,
    } = data;
    
    const lectureElement = document.querySelector('.lecture-list-item')
    const copyable = lectureElement.querySelector('.lecture-link');
    lectureElement.innerHTML = '';
    titles.forEach((title, index) => {
      const el = copyable.cloneNode();
      el.innerHTML = title;
      el.href = `#edu?lec=${paramObject.lec}&page=${index}`;
      lectureElement.appendChild(el);
    })

    console.log(document.querySelector('.youtube-iframe').src);
    document.querySelector('.article-title').innerHTML = titles[index];
    document.querySelector('.article-contents').innerHTML = content;
    document.querySelector('.youtube-iframe').src = src;
  })
})();
</script>